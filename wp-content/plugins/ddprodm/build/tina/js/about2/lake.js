!function(e){jQuery.fn.lake=function(a){var t,s,i,r,h=e.extend({speed:1,scale:1,waves:10,image:!0},a),n=h.waves,g=h.speed/4,v=h.scale/2,o=document.createElement("canvas"),c=o.getContext("2d"),d=this.get(0),f=!1;d.parentNode.insertBefore(o,d);var m=0,u=0,l=0,w=[];return d.onload=function(){c.save(),c.canvas.width=this.width,c.canvas.height=2*this.height,c.drawImage(this,0,0),c.scale(1,-1),c.drawImage(this,0,2*-this.height),f=!0,c.restore(),t=c.canvas.width,s=c.canvas.height,i=t,r=s/2;var e=c.getImageData(0,s/2,t,s).data,a=!1;for(c.save();!a;){for(var o=c.getImageData(0,s/2,t,s),d=o.data,I=0,p=0;p<r;p++)for(var D=0;D<i;D++){var j=10*v*Math.sin(r/(p/n)-m)|0,x=4*((j+p)*t+D+j);if(x<0)I+=4;else{var y=x%(4*t),Q=10*v*(p/n);if(y<Q||y>4*t-Q){var k=p<t/2?1:-1;d[I]=d[I+4*k],d[++I]=d[I+4*k],d[++I]=d[I+4*k],d[++I]=d[I+4*k],++I}else 0!==e[x+3]?(d[I]=e[x],d[++I]=e[++x],d[++I]=e[++x],d[++I]=e[++x],++I):(d[I]=d[I-4*t],d[++I]=d[I-4*t],d[++I]=d[I-4*t],d[++I]=d[I-4*t],++I)}}m>g*(6/g)?(m=0,l=u-1,u=0,a=!0):(m+=g,u++),w.push(o)}c.restore(),h.image||(c.height=c.height/2)},setInterval(function(){f&&(h.image?c.putImageData(w[u],0,s/2):c.putImageData(w[u],0,0),u<l?u++:u=0)},33),this}}(jQuery);